!function(t,r){"function"==typeof define&&define.amd?define([],r):"object"==typeof module&&module.exports?module.exports=r():t.nvFormat=r()}(this,function(){"use strict";return function(){var t,y={floor:{1:Math.floor.bind(Math),"-1":Math.ceil.bind(Math)},ceil:{1:Math.ceil.bind(Math),"-1":Math.floor.bind(Math)},round:{1:Math.round.bind(Math),"-1":Math.round.bind(Math)}},F=/(?:^|\()\s*(\+x|\+d|x|d|\d)d*\d*[\.,]?d*\d*\s*(?:\)|$)/,w=/\d+/,A=/[^\(\s\)]+/,$=/\d+.*?d+/,k=/[<>& ]/g,f={},q={trunc:"floor",filler:"0",format:"d",point:"",delimiter:"",prefix:"",postfix:"",output:""},a="";for(t in q)a+=q[t]+"-";function z(t){return"[object Object]"===Object.prototype.toString.call(t)}var r,B=(r={"<":"&lt;",">":"&gt;","&":"&amp;"," ":"&nbsp;"},function(t){return t in r?r[t]:t}),u=function(t,r){if("clear"===t)return f={},u;var n=a,i=z(t);if(i)for(var e in n="",q)e in t?n+=t[e]+"-":n+=q[e]+"-";var O,o=f[n];if(!o){var j={};for(e in q)i&&e in t?j[e]=t[e]:j[e]=q[e];O={},o=function(t,r,n){var i=+t;if(!isFinite(i))return t.toString();z(r)&&(n=r,r=null);var e,o=z(n);for(e in j)o&&e in n?O[e]=n[e]:O[e]=j[e];for(e in"string"==typeof r&&(O.format=r),O)"string"!=typeof O[e]&&(O[e]=q[e]);if(O.trunc in y||(O.trunc="floor"),!(f=F.exec(O.format)))return i.toString();var f=f[0],a=A.exec(f);if(!a)return i.toString();if(!(a=a[0]).length)return i.toString();if($.test(a))return i.toString();var u=O.format.indexOf(f),l=u+f.length;if(u<0)return i.toString();if(l>O.format.length)return i.toString();var d=O.format.substring(0,u),s=O.format.substring(l),c=0===a.indexOf("+"),h=a,g="",p=0===(h=c?a.slice(1):h).indexOf("x"),t=Math.abs(i),r=i<0?-1:1;0<r&&c&&(g="+"),r<0&&(g="-");f=y[O.trunc][r],u=h,l=".",a=h.indexOf(".");a<0&&-1<(a=h.indexOf(","))&&(l=","),""!==O.point&&(l=O.point);c=h.length,r=0;if(0===a)return i.toString();if(a>h.length-2)return i.toString();0<a&&(r=h.length-(c=a)-1,u=h.slice(0,a)+h.slice(a+1));a=1,u=u.match(w);u&&(a=0!=+u[0]?+u[0]:+("1"+u[0]));var u=Math.pow(10,r),t=t*u,t=f((t=Math.abs(t-Math.round(t))<1e-6?Math.round(t):t)/a)*a,b=(t/=u).toString(),m=(b="."!==l?b.replace(".",l):b).indexOf(l);m<0&&(m=b.length,0<r&&(b+=l));l=b.length-1-m;0<r&&l<r&&(b+="0".repeat(r-l));l=m;if(m<c&&(b=O.filler.repeat(c-m)+b,m=c),p&&c<m&&(b=b.slice(-(b.length-(v=m-c))),m=c,l-=v),""!==O.delimiter&&3<m){var x,M=[],p=!1,c=O.delimiter;1<c.length&&"r"===c.charAt(0)&&(c=c.substring(1),p=!0);for(var v="0"===O.filler,S=v&&!p||p&&!v?(x=0,(m-1)%3+1):(x=m-l)+(l-1)%3+1,l=x;S<=m;)M.push(b.substring(x,S)),x=S,S+=3;c=M.join(c);b=b.substring(0,l)+c+b.substring(m)}s=(d=O.prefix+d)+(g+b)+(s+=O.postfix);return s="html"===O.output?s.replace(k,B):s}}return r||(f[n]=o),o};return u}()});